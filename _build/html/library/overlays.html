
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Overlays &mdash; OpenLayers</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenLayers" href="../index.html" />
    <link rel="up" title="OpenLayers Library Documentation" href="index.html" />
    <link rel="next" title="Styling" href="feature_styling.html" />
    <link rel="prev" title="Formats" href="formats.html" />
  <link rel="stylesheet" href="http://openlayers.org/two/css/common.css" type="text/css" />
  <link rel="stylesheet" href="http://openlayers.org/two/css/website.css" type="text/css" />
  <meta name="verify-v1" content="p07VY29NG/hLEwVP1RyE0P1chgYyekPikjkMUEgrVAI=" />
  <!--[if lt IE 7]>
  <script defer="defer" type="text/javascript" src="http://openlayers.org/pngfix.js"></script>
  <![endif]-->
  <style type='text/css'>
    body {
     font-family: sans-serif;
     font-size: .9em;
    }
  </style>

  </head>
  <body role="document">
<div id="olbanner">
<img class="openlayersbannerimg" src="http://openlayers.org/two/images/OpenLayers.trac.png" style="height: 44px; width: 49px;border:0px" alt="OpenLayers" />
<a class="openlayersbanner" href="http://www.openlayers.org/two/" >
OpenLayers 2</a>
</div>
<div id="navcontainer">
<a class="navtabtraccurrent" href="http://www.openlayers.org">Home</a>
<a class="navtab" href="http://trac.osgeo.org/openlayers">Support &amp; Development</a>
</div>

<div id="mainnav" class="nav"><ul><li class="first"><a href="http://www.openlayers.org/sponsorship/">Sponsorship</a></li><li><a href="http://trac.openlayers.org/wiki" accesskey="1">Wiki</a></li><li><a href="http://openlayers.org/blog/">Blog</a></li><li><a href="http://trac.osgeo.org/openlayers/wiki/FrequentlyAskedQuestions">FAQ</a></li><li><a href="http://trac.osgeo.org/openlayers/wiki/HowToDownload" accesskey="3">Download</a></li><li><a href="http://trac.osgeo.org/openlayers/wiki/MailingLists">Email Lists</a></li></ul></div>



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="feature_styling.html" title="Styling"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="formats.html" title="Formats"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">OpenLayers</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../contents.html" >Table of Contents</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">OpenLayers Library Documentation</a> &raquo;</li> 
      </ul>
    </div>


      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Overlays</a><ul>
<li><a class="reference internal" href="#overlay-basics">Overlay Basics</a></li>
<li><a class="reference internal" href="#vector-overlays">Vector Overlays</a><ul>
<li><a class="reference internal" href="#interaction">Interaction</a></li>
<li><a class="reference internal" href="#layer-types">Layer Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#marker-overlays">Marker Overlays</a><ul>
<li><a class="reference internal" href="#id4">Interaction</a></li>
<li><a class="reference internal" href="#id5">Layer Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transitioning-from-text-layer-or-georss-layer-to-vectors">Transitioning from Text Layer or GeoRSS Layer to Vectors</a><ul>
<li><a class="reference internal" href="#loading-data">Loading Data</a><ul>
<li><a class="reference internal" href="#loading-data-with-a-gml-layer">Loading data with a GML Layer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#styling-data">Styling Data</a></li>
<li><a class="reference internal" href="#displaying-popups">Displaying Popups</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../contents.html">Table of Contents</a><ul>
  <li><a href="index.html">OpenLayers Library Documentation</a><ul>
      <li>Previous: <a href="formats.html" title="previous chapter">Formats</a></li>
      <li>Next: <a href="feature_styling.html" title="next chapter">Styling</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/overlays.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div><div class="body">
<h3 style="background-color: yellow">You are viewing outdated docs</h3>
<p>OpenLayers 2.x is not under active development any more. Go to <a href="http://openlayers.org/en/latest/doc/">http://openlayers.org/en/latest/doc/</a> to view the latest OpenLayers 3.x docs.</p>
</div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="overlays">
<span id="id1"></span><h1>Overlays<a class="headerlink" href="#overlays" title="Permalink to this headline">¶</a></h1>
<p>OpenLayers allows you to lay many different types of data on top of its various
data sources. Currently, there are two main ways of displaying vector feature
overlays in OpenLayers, each with benefits and drawbacks. This document seeks
to describe the differences, and ways in which each can be used.</p>
<div class="section" id="overlay-basics">
<h2>Overlay Basics<a class="headerlink" href="#overlay-basics" title="Permalink to this headline">¶</a></h2>
<p>There are two different types of feature rendering in OpenLayers.  One type is
the OpenLayers <a class="reference internal" href="#vector-overlays"><span class="std std-ref">Vector Overlays</span></a> support, which uses vector drawing
capabilities in the browser (SVG, VML, or Canvas) to display data. The other
type is the OpenLayers <a class="reference internal" href="#marker-overlays"><span class="std std-ref">Marker Overlays</span></a> support. This type of layer displays HTML
image objects inside the DOM.</p>
<p>In general, the Vector layer provides more capabilities, with the ability to
draw lines, polygons, and more. The Vector-based Layers are better maintained,
and are the place where most new OpenLayers development is taking place.
There is more support for various styling options, and more configurability
over layer behavior and interactions with remote servers.</p>
<p>However, the Markers layer is maintained for backwards compatibility, because
there are some things you can not do with vectors as they are currently
implemented, and they provide a different type of interface for event
registration.</p>
</div>
<div class="section" id="vector-overlays">
<span id="id2"></span><h2>Vector Overlays<a class="headerlink" href="#vector-overlays" title="Permalink to this headline">¶</a></h2>
<p>Vector Layers form the core of Vector overlays. Vector overlays are powered
by adding sets of OpenLayers.Feature.Vectors to the map. These can be a number
of types of geometry:</p>
<blockquote>
<div><ul class="simple">
<li>Point / MultiPoint</li>
<li>Line / MultiLine</li>
<li>Polygon / MultiPolygon</li>
</ul>
</div></blockquote>
<p>They are styled using the OpenLayers.Style / OpenLayers.StyleMap properties.</p>
<p>Examples:</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://openlayers.org/dev/examples/stylemap.html">StyleMap Example</a>:</dt>
<dd><p class="first last">Use &#8220;Rules&#8221; to determine style attributes based on feature properties.
This is useful for rendering based on data attributes like population.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://openlayers.org/dev/examples/styles-context.html">Context Example</a>:</dt>
<dd><p class="first last">Use a custom Javascript function to determine feature
style properties. This example shows how to use which quadrant of the
world a feature is in to determine its color. Similar rules can be
used to do computations on a feature property to generate a style value
(like size).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://openlayers.org/dev/examples/styles-rotation.html">Rotation Example</a>:</dt>
<dd><p class="first last">Vector features support advanced styling, like feature rotation. This can
be used, for example, to display vehicle direction, wind direction, or
other direction-based attributes.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://openlayers.org/dev/examples/styles-unique.html">Unique Value Style Example</a>:</dt>
<dd><p class="first last">A common use case is to pick a specific style value based on a key/value
mapping of a feature. This example demonstrates how to do that.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<div class="section" id="interaction">
<h3>Interaction<a class="headerlink" href="#interaction" title="Permalink to this headline">¶</a></h3>
<p>Vector layer interaction is achieved through the SelectFeatureControl. This control
allows selection of features, using DOM events to capture which feature is clicked
on.</p>
<p>To handle feature events on a Vector Layer, you use the SelectFeature control,
in combination with an event listener registered on the layer, on the
&#8216;featureselected&#8217; event.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">selected</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">feature</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot; selected on &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayes</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="s2">&quot;VLayer&quot;</span><span class="p">);</span>
<span class="nx">layer</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;featureselected&quot;</span><span class="p">,</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">selected</span><span class="p">);</span>
</pre></div>
</div>
<p>Once you have done this, you can add a select feature control to your map:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">control</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">SelectFeature</span><span class="p">(</span><span class="nx">layer</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">control</span><span class="p">);</span>
<span class="nx">control</span><span class="p">.</span><span class="nx">activate</span><span class="p">();</span>
</pre></div>
</div>
<p>The activate call will move the vector layer to the forefront of the map, so
that all events will occur on this layer.</p>
<p>As of OpenLayers 2.7, there is no support for selecting features from more than
a single vector layer at a time. The layer which is currently being used for
selection is the last one on which the <code class="docutils literal"><span class="pre">.activate()</span></code> method of the attached
select feature control was called.</p>
</div>
<div class="section" id="layer-types">
<h3>Layer Types<a class="headerlink" href="#layer-types" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="layers.html#layer-vector"><span class="std std-ref">Vector</span></a> (Base Class)</li>
<li><a class="reference internal" href="layers.html#layer-gml"><span class="std std-ref">GML</span></a> &#8211; can load many different types of data.</li>
<li><a class="reference internal" href="layers.html#layer-pointtrack"><span class="std std-ref">PointTrack</span></a></li>
<li><a class="reference internal" href="layers.html#layer-wfs"><span class="std std-ref">WFS</span></a></li>
</ul>
</div>
</div>
<div class="section" id="marker-overlays">
<span id="id3"></span><h2>Marker Overlays<a class="headerlink" href="#marker-overlays" title="Permalink to this headline">¶</a></h2>
<p>Markers support only point geometries. They are styled only using the
OpenLayers.Icon class. They do not support lines, polygons, or other complex
features. Their interaction method differs significantly from vector layers.</p>
<p>In general, Markers are the &#8216;older&#8217; way to interact with geographic data in
the browser. Most new code should, where possible, use vector layers in place
of marker layers.</p>
<div class="section" id="id4">
<h3>Interaction<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Interaction on marker layers is achieved by registering events on the
individual marker event property:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Marker</span><span class="p">(</span><span class="nx">lonlat</span><span class="p">);</span>
<span class="nx">marker</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="nx">marker</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span> <span class="nx">marker</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Any number of events can be registered, and different events can be registered
for each feature.</p>
</div>
<div class="section" id="id5">
<h3>Layer Types<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="layers.html#layer-markers"><span class="std std-ref">Markers</span></a> (Base Class)</li>
<li><a class="reference internal" href="layers.html#layer-georss"><span class="std std-ref">GeoRSS</span></a></li>
<li><a class="reference internal" href="layers.html#layer-text"><span class="std std-ref">Text</span></a></li>
<li><a class="reference internal" href="layers.html#layer-boxes"><span class="std std-ref">Boxes</span></a> (Uses Special &#8220;Box&#8221; Marker)</li>
</ul>
</div>
</div>
<div class="section" id="transitioning-from-text-layer-or-georss-layer-to-vectors">
<span id="transition-markers-to-vectors"></span><h2>Transitioning from Text Layer or GeoRSS Layer to Vectors<a class="headerlink" href="#transitioning-from-text-layer-or-georss-layer-to-vectors" title="Permalink to this headline">¶</a></h2>
<p>Many OpenLayers-applications make use of the <a class="reference internal" href="layers.html#layer-text"><span class="std std-ref">Text</span></a> Layer or
<a class="reference internal" href="layers.html#layer-georss"><span class="std std-ref">GeoRSS</span></a> Layer, which each parse a file (tab separated values) and
displays markers an the provided coordinates.  When clicking on one of the
markers a popup opens and displays the content of the name and description
from that location.</p>
<p>This behavior is relatively easy to achieve using vector layers, and doing so
allows for more configurability of the behavior when clicking on a feature.
Instead of being forced to use popups, you can instead cause the browser to
go to a new URL, or change the behavior in other ways.</p>
<div class="section" id="loading-data">
<h3>Loading Data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h3>
<p>To mimic the loading behavior of a <a class="reference internal" href="layers.html#layer-text"><span class="std std-ref">Text</span></a> Layer or a
<a class="reference internal" href="layers.html#layer-georss"><span class="std std-ref">GeoRSS</span></a> Layer, there are two options:</p>
<ul class="simple">
<li>Use a <a class="reference internal" href="layers.html#layer-gml"><span class="std std-ref">GML</span></a> Layer &#8211; covered in this document.</li>
<li>Use a <a class="reference internal" href="layers.html#layer-vector"><span class="std std-ref">Vector</span></a> Layer, with a strategy and protocol.</li>
</ul>
<p>In either case, the way for controlling the behavior of the feature selection
is the same.</p>
<div class="section" id="loading-data-with-a-gml-layer">
<h4>Loading data with a GML Layer<a class="headerlink" href="#loading-data-with-a-gml-layer" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="layers.html#layer-gml"><span class="std std-ref">GML</span></a> Layer is a simple &#8220;Load data from a URL once&#8221; data layer.
You provide it a URL, and a format to use, and it will load the data from the
URL, and parse it according to the format.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">GML</span><span class="p">(</span><span class="s2">&quot;Layer Name&quot;</span><span class="p">,</span>
   <span class="s2">&quot;http://example.com/url/of/data.txt&quot;</span><span class="p">,</span>
   <span class="p">{</span> <span class="nx">format</span><span class="o">:</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Format</span><span class="p">.</span><span class="nx">Text</span> <span class="p">});</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">layer</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">zoomToMaxExtent</span><span class="p">();</span>
</pre></div>
</div>
<p>This will cause your data to load, displaying your data as points on the map.</p>
</div>
</div>
<div class="section" id="styling-data">
<h3>Styling Data<a class="headerlink" href="#styling-data" title="Permalink to this headline">¶</a></h3>
<p>Some data formats do not include styling information, like GeoRSS. In order to
match the default OpenLayers style to the default marker in OpenLayers, you
should create a StyleMap that matches the default OpenLayers style:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Style</span><span class="p">({</span>
    <span class="s1">&#39;externalGraphic&#39;</span><span class="o">:</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">getImagesLocation</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;marker.png&quot;</span><span class="p">,</span>
    <span class="s1">&#39;graphicHeight&#39;</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span>
    <span class="s1">&#39;graphicWidth&#39;</span><span class="o">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s1">&#39;graphicXOffset&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mf">10.5</span><span class="p">,</span>
    <span class="s1">&#39;graphicYOffset&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mf">12.5</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styleMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">StyleMap</span><span class="p">({</span><span class="s1">&#39;default&#39;</span><span class="o">:</span><span class="nx">style</span><span class="p">});</span>

<span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">GML</span><span class="p">(</span><span class="s2">&quot;Layer Name&quot;</span><span class="p">,</span>
   <span class="s2">&quot;http://example.com/url/of/data.txt&quot;</span><span class="p">,</span>
   <span class="p">{</span>
     <span class="nx">format</span><span class="o">:</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Format</span><span class="p">.</span><span class="nx">GeoRSS</span><span class="p">,</span>
     <span class="nx">styleMap</span><span class="o">:</span> <span class="nx">styleMap</span>
   <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Using a style map like this will result in no visible difference when your
feature is selected. To create a different style for selection &#8211; for
example, with a different marker color &#8211; you could craft a second style
object, and instead create your styleMap like:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">styleMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">StyleMap</span><span class="p">({</span>
    <span class="s1">&#39;default&#39;</span><span class="o">:</span> <span class="nx">style</span><span class="p">,</span>
    <span class="s1">&#39;select&#39;</span><span class="o">:</span> <span class="nx">selectStyle</span>
<span class="p">});</span>
</pre></div>
</div>
<p>For more information on styling your features, see the <a class="reference internal" href="feature_styling.html#styling"><span class="std std-ref">Styling</span></a> or <a class="reference internal" href="feature_styling.html#stylemap"><span class="std std-ref">StyleMap</span></a> documentation.</p>
</div>
<div class="section" id="displaying-popups">
<h3>Displaying Popups<a class="headerlink" href="#displaying-popups" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="layers.html#layer-text"><span class="std std-ref">Text</span></a> Layer and the <a class="reference internal" href="layers.html#layer-georss"><span class="std std-ref">GeoRSS</span></a> Layer open popups
containing title and description text for the feature when clicked. Replicating
this behavior in your application is easy.</p>
<p>First, define a set of functions for managing your popup.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">onPopupClose</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// &#39;this&#39; is the popup.</span>
    <span class="nx">selectControl</span><span class="p">.</span><span class="nx">unselect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">feature</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">onFeatureSelect</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">feature</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">feature</span><span class="p">;</span>
    <span class="nx">popup</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Popup</span><span class="p">.</span><span class="nx">FramedCloud</span><span class="p">(</span><span class="s2">&quot;featurePopup&quot;</span><span class="p">,</span>
                             <span class="nx">feature</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">().</span><span class="nx">getCenterLonLat</span><span class="p">(),</span>
                             <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Size</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>
                             <span class="s2">&quot;&lt;h2&gt;&quot;</span><span class="o">+</span><span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/h2&gt;&quot;</span> <span class="o">+</span>
                             <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">description</span><span class="p">,</span>
                             <span class="kc">null</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">onPopupClose</span><span class="p">);</span>
    <span class="nx">feature</span><span class="p">.</span><span class="nx">popup</span> <span class="o">=</span> <span class="nx">popup</span><span class="p">;</span>
    <span class="nx">popup</span><span class="p">.</span><span class="nx">feature</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">;</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">addPopup</span><span class="p">(</span><span class="nx">popup</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">onFeatureUnselect</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">feature</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">feature</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">popup</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">popup</span><span class="p">.</span><span class="nx">feature</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">map</span><span class="p">.</span><span class="nx">removePopup</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">popup</span><span class="p">);</span>
        <span class="nx">feature</span><span class="p">.</span><span class="nx">popup</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="nx">feature</span><span class="p">.</span><span class="nx">popup</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, we define two event handlers on the layer to call these functions
appropriately. We use the layer definition from above, and assume that the
layer has been added to the map. We also add a select feature control, to
actually trigger the events:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">layer</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">on</span><span class="p">({</span>
    <span class="s1">&#39;featureselected&#39;</span><span class="o">:</span> <span class="nx">onFeatureSelect</span><span class="p">,</span>
    <span class="s1">&#39;featureunselected&#39;</span><span class="o">:</span> <span class="nx">onFeatureUnselect</span>
<span class="p">});</span>
<span class="nx">selectControl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">SelectFeature</span><span class="p">(</span><span class="nx">layer</span><span class="p">);</span>
</pre></div>
</div>
<p>Combining these two sections of code will cause the map to open a popup
any time the feature is selected, and close the popup when the feature is
unselected or the close button is pressed.</p>
<p>The HTML in the fourth argument to the FramedCloud constructor is based
on the type of data you are parsing. This example is based around the Text
Layer, but you can do the same with a KML layer by changing the &#8216;title&#8217; to
&#8216;name&#8217;. The GeoRSS Layer could use the <code class="docutils literal"><span class="pre">feature.attributes.link</span></code> property
in addition, to create a link to the feature.</p>
<p>It is worth noting that this content &#8211; passed to the FramedPopup constructor
&#8211; is set using innerHTML, and as such, is subject to XSS attacks if the
content in question is untrusted. If you can not trust the content in your
source files, you should employ some type of stripping to remove possibly
malicious content before setting the popup content to protect your site
from XSS attacks.</p>
<p>Once you&#8217;ve done this, you can customize the behavior of your layer to your
heart&#8217;s content. Change the layout of your popup HTML, change the type of
popup, or change the click behavior to instead open a new window &#8211; it&#8217;s
all possible, and simple, with the functionality provided by the vector
layers and SelectFeatureControl.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
    &copy; Copyright 2008, OpenLayers.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-2577926-1");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>